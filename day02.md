### 2.1 ~ 2.3 小结：

1. CPU 是由运算器、控制器、寄存器等器件构成，这些器件靠内部总线相连，每个部件各司其职：

   - 运算器进行信息处理
   - 寄存器进行信息存储
   - 控制器控制各种器件进行工作
   - 内部总线连接各种器件，在它们自己进行数据传输

   

2. 一个 16 位寄存器可以存储 16 位的数据，但是为了兼容上一代 CPU ，将一个寄存器分为了两个可以独立使用的 8 位寄存器，即 AX 寄存器可分为 AH 和 AL 两个寄存器

![16位寄存器分成的两个8位寄存器](./images/16%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8%E5%88%86%E6%88%90%E7%9A%84%E4%B8%A4%E4%B8%AA8%E4%BD%8D%E5%AF%84%E5%AD%98%E5%99%A8.png)



3. 一种新的数据格式：字，记为 word

   - 一个字由两个字节组成，这两个字节分别被称为这个字的高位字节（AH）和低位字节（AL）

   

4. 几条简单的汇编指令：

![汇编指令举例](./images/%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E4%B8%BE%E4%BE%8B.png)

*在编写汇编指令或寄存器名称时，都不会区分大小写*



5. 当进行数据传送或运算时，要注意指令的两个操作对象的位数是一致的，例如：

   - 正确的：

     ```
     mov ax,bx
     mov bx,cx 
     mov ax,18H
     mov al,18H
     add ax,bx
     add ax,20000
     ```

   - 错误的：

     ```
     mov ax,bl       // 在 8 位寄存器和十六位寄存器之间传送数据
     mov bh,ax       // 在 16 位寄存器和 8 位寄存器之间传送数据
     mov al,20000    // 8 位寄存器最大可存放值为 255 的数据
     add al,100H     // 将一个高于 8 位的数据加到一个 8 位寄存器中
     ```

---

### 2.4 ~ 2.8 小结：

1. 在 8086CPU 访问内存单元时，必须向内存提供内存单元的物理地址，而得到物理地址办法就是段地址加上偏移地址。

   

2. 物理地址的计算公式：`SA（段） * 16 + EA（偏） = PA（物）`，CPU 可以用不同的段地址和偏移地址形成同一个物理地址，只需要满足公式条件即可。

   

3. 段地址是一个范围内的内存单元组成的，例如 10000H~100FFH 就可以称为一个段地址，该段的起始地址为 10000H（1000h * 10h），段地址为 1000H，大小为 100H（100FFh - 10000h + 1h）

   

4. 偏移地址是 16 位的，最多可寻址 64KB 个内存单元，即变化范围为：0H~FFFFH

---

### 2.9 ~ 2.11 小结：

1. 段地址在 8086CPU 的段寄存器中存放，当 8086CPU 要访问内存时，由段寄存器提供内存单元的段地址

    

2. 8086CPU 有 4 个段寄存器，其中 CS 是用来存放段地址的，IP 是存放偏移位的

    

3. 8086CPU 的工作过程：

   1. CS:IP 经过地址加法器，得到内存单元的物理地址

4. 向指向的内存单元中读取指令，读取的指令进入指令缓冲器

   3. IP = IP + 所读取指令的长度，从而指向下一条指令

5. 执行指令，然后转到步骤(1)，重复这个过程

![8086CPU读取和执行指令的概念](./images/8086CPU%E8%AF%BB%E5%8F%96%E5%92%8C%E6%89%A7%E8%A1%8C%E6%8C%87%E4%BB%A4%E7%9A%84%E6%A6%82%E5%BF%B5.png)



4. 8086CPU 提供了转移指令修改 CS:IP 的内容：`jmp`

   如果我们希望修改 CS:IP 的内容，可以使用 `jmp 段地址:偏移地址` 的指令来实现，如下：

   - 指令一：`jmp 2AE3:3` 

     - 执行后：CS=2AE3H, IP=0003H，CPU 将从 2AE33H 处读取指令

   - 指令二：`jmp 3:0B16`

     - 执行后：CS=0003H, IP=0B16H，CPU 将从 00B46H 处读取指令

     

   若仅想修改 IP 位的内容，可以使用 `jmp 某个合法寄存器` 的指令来实现，如下：

   - 指令一：`jmp ax`

     - 执行前：ax=1000H, CS=2000H, IP=0003H

     - 执行后：ax=1000H, CS=2000H, IP=1000H

   - 指令二：`jmp bx`

     - 执行前：bx=0B16H, CS=2000H, IP=0003H

     - 执行后：bx=0B16H, CS=2000H, IP=0B16H

   - 该指令的含义上好似：`mov IP,ax;`


---

### Debug 使用教程

Debug 是 windows 提供的实模式程序的调试工具，使用它可以查看 CPU 各种寄存器中的内容，内存的情况和在机器码级跟踪程序的运行。

以下是常用到的 Debug 功能：

- 命令 R ：查看、改变 CPU 寄存器的内容

  - 查看寄存器内容：-R

- 修改CS内容：-RCS

  - 修改IP内容：-RIP

  

- 命令 D ：查看内存中的内容

  - 查看 1000:0000 的内容：-D 1000:0（会输出 128 个内存单元的内容）
  - 查看 1000:0000~000f 的内容：-D 1000:0 f

  

- 命令 E ：改写内存中的内容

  - 修改 1000:0 的内容：-E 1000:0（[修改前的数据].[需要修改的值]）
  - 修改 1000:0~5 的内容：-E 1000:0 AA BB CC DD EE FF 00
  - 修改 1000 中的多个内容，且以ascii码写入：-E 1000:0 1 'a' 2 'b' 3 'c'
  - 写入字符串：-E 1000:0 1 "a+b" 2 "c++" 3 "IBM"

  

- 命令 U ：将内存中的机器指令翻译成汇编指令

  - 查看以 1000:0 开始的机器指令，并翻译为汇编指令：-U 1000:0

  

- 命令 T ：执行一条机器指令



- 命令 A ：以汇编指令的格式在内存中写入一条机器指令

  - 从 1000:0 处开始写入汇编指令：-A 1000:0

